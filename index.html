
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">


<!-- This is based on some code if found and modified. Unfortunately I cannot find the link again -->

<html lang="en">
<head>
	<title>Sandro's Tricky Words</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<link rel="icon" type="image/png" href="image.png" />
	<link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
	<link rel="manifest" href="/manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">
	
	<script
		  src="https://code.jquery.com/jquery-3.3.1.min.js"
		  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
		  crossorigin="anonymous"></script>

	<style type="text/css" media="screen">
		@font-face {
		    font-family: BrandonGrot;
		    src: url("Brandon_med.otf") format("opentype");
		}

        body { background-color: #ffdddd; color: #333333; font-family: "BrandonGrot", 'Trebuchet MS', cursive; text-rendering:optimizeLegibility; }
        #controls { width: 900px; margin: 0px auto; height: 40px; }
        #card_container { font-size:100pt; text-align: center; padding: 150px 0px; }
        #start { font-size:100pt; text-align: center; padding: 150px 0px; }
        #end { font-size:100pt; text-align: center; padding: 150px 0px; }
        #counter_container {  width: 30px;  font-size: 50pt; color: #333; }
        #counter { float: left;}
        
	</style>
	<script language="Javascript">

	$( document ).ready(function() {
			var wordList = [ ];
			var progressWaitInMillis = 3000;


			$.getJSON("sandro.json", function(data) {
					wordList = wordList.concat(data.words.current)
					var rand  = pickRandom(5, data.words.historic)
					wordList = wordList.concat(rand)

					$("#start").click(start)
			});

			
			var wordIndex = 0;
			var words;
			var timer = null;
			var startTime = 0;
			var wordTime = 0;

			function each(a,f) { for (var i=0,l=a.length;i<l;i++) f(a[i]); }

			var start = function() {
				$('#card_container').html('<span id="card"></span>');
				$('#card').click(reveal)
			
				words = [];
				each(wordList, function(word) { words.push(word); });
				for ( var i=0,l=words.length; i < l; i++ ) {
					var sindex = Math.floor(Math.random()*l);
					var temp = words[sindex];
					words[sindex] = words[i];
					words[i] = temp;
				}
				wordIndex = -1;
				nextWord();
			}

			function pickRandom(num, array) {
				var randomWords = []
				for(var i = 0; i < num; i++) {
					var pos = Math.floor(Math.random()*array.length)
					var word = array[pos]
					randomWords.push(word)
					array.splice(pos, 1)
				}
				return randomWords;
			}
		
			
			function nextWord() {
				wordIndex++
				var currentCounter = ''+(words.length - wordIndex)
				$('#counter').text(currentCounter);
				if ( wordIndex >= words.length ) {
					end();
					return;					
				}
				$('#card').text(words[wordIndex]);
				
			}
			
			function end() {
				$('#card_container').html('<span id="end">The End!</span>');
			}

			function sayWord() {
				$("#sound").html("<audio src=http://api.voicerss.org/?key=c7390581f1e84a388be14b8cdf507a8f&hl=en-gb&r=-2&f=44khz_16bit_stereo&ssml=false&src="+encodeURI(words[wordIndex])+" autoplay='autoplay'></audio>")
			}

			var progress = function() {
				setTimeout(function() { 
					$('#card').css('color', "#333333")
					$('#counter').css('color', "#333333")
					$('#spinner').html('')
					$('#card').bind('click', reveal)
					nextWord();
				}, progressWaitInMillis);
			}

			var reveal = function( evt ) {
				$('#card').unbind('click', reveal);
				sayWord();	
								
				$('#card').css('color', "#ff6633")
				$('#counter').css('color', "#ff6633")
				$('#spinner').html('<img src="spinner2.gif"/>');
				progress()
			}
			
			
			
		});
		
	</script>
</head>
<body>
<div id="controls">
	<span id="counter_container">
		<span id="counter"></span>
		<span id="spinner"></span>
	</span>

</div>
<div id="card_container">
		<span id="start">start...</span>
</div>
<div id="sound"></div>


</body>
</html>
